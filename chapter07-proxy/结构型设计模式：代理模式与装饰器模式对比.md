# 结构型设计模式：代理模式与装饰器模式对比

代理模式和装饰器模式都属于**结构型设计模式**，核心都是通过“包装对象”实现功能扩展，但二者的**设计目的、核心关注点**完全不同，具体区别可以通过下表清晰对比：

|对比维度|**代理模式**|**装饰器模式**|
|---|---|---|
|核心目的|控制对**目标对象的访问**，附加的增强逻辑是为了辅助访问控制（如权限校验、日志记录、懒加载）|给**目标对象动态添加新功能**，核心是功能扩展（如给基础订单服务添加优惠券、积分抵扣功能）|
|关系定位|代理对象与目标对象是**“控制者-被控制者”** 的关系，客户端完全可以只依赖代理对象|装饰器对象与目标对象是**“增强者-被增强者”** 的关系，客户端可以灵活组合多个装饰器|
|功能逻辑|增强逻辑（如权限校验）是**代理自身的逻辑**，与目标对象的核心功能无关|增强逻辑是**目标对象功能的延伸**，与核心功能强相关（如订单创建+积分计算）|
|对象获取方式|代理对象通常**自行创建或管理目标对象**，客户端无需关心目标对象的实例化|装饰器对象**由客户端传入目标对象**，且支持多层装饰器嵌套（如 `装饰器A(装饰器B(目标对象))`）|
|适用场景|权限控制、远程代理、懒加载、日志监控|动态功能扩展、多层功能叠加（如IO流的包装、多维度的业务增强）|
### 简单例子理解

1. **代理模式示例**

你想调用一个远程订单接口，直接调用会有网络连接、权限校验的问题。此时可以创建一个**远程代理**，代理内部帮你处理网络连接、权限校验，你只需要调用代理的方法，无需关心底层细节。

这里代理的核心是**控制你对远程接口的访问**，附加的网络、权限逻辑和“创建订单”的核心功能无关。

1. **装饰器模式示例**

一个基础的订单服务只能创建订单，现在需要给它添加“积分抵扣”“优惠券减免”功能。你可以创建两个装饰器：`积分装饰器`和`优惠券装饰器`，客户端可以灵活组合：

- 基础订单服务 → 只能创建订单

- `积分装饰器(基础订单服务)` → 创建订单+积分抵扣

- `优惠券装饰器(积分装饰器(基础订单服务))` → 创建订单+积分抵扣+优惠券减免

这里装饰器的核心是**给订单服务叠加新功能**，所有增强逻辑都和订单业务强相关。

### 核心总结

- **代理模式**：强调**“控制访问”**，增强逻辑是“非业务辅助逻辑”，代理和目标对象是一对一的控制关系。

- **装饰器模式**：强调**“动态扩展”**，增强逻辑是“业务功能逻辑”，支持多层装饰器嵌套组合。

---

我可以帮你整理**代理模式与装饰器模式的代码对比示例**，让你更直观地看到两者的实现差异，需要吗？
> （注：文档部分内容可能由 AI 生成）