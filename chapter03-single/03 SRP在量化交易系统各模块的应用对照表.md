# SRP在量化交易系统各模块的应用对照表

|层级|模块/类/方法|核心职责|违反SRP的典型情况|遵循SRP的设计方案|变化原因独立的优势|
|---|---|---|---|---|---|
|**微服务/模块层级**|行情模块|实时行情数据的接收、解析、存储、推送|行情模块同时包含策略计算逻辑|拆分出独立的**行情微服务**，仅处理行情相关操作|行情协议变更（如新增TCP行情源）时，不影响策略模块|
||策略模块|交易策略的编写、回测、实盘执行|策略模块同时负责订单提交、风控校验|拆分出**策略微服务**，仅处理策略逻辑；订单提交交给订单模块|策略算法迭代（如新增均线策略）时，不影响订单和风控逻辑|
||订单模块|订单的创建、提交、撤单、状态查询|订单模块同时处理行情订阅、风控规则|拆分出**订单微服务**，仅对接交易所接口处理订单|交易所接口变更（如API版本升级）时，不影响策略和行情模块|
||风控模块|实时仓位校验、资金校验、合规校验|风控模块同时负责订单存储、日志记录|拆分出**风控微服务**，仅执行风险校验规则|风控规则调整（如新增仓位上限）时，不影响其他模块|
|**类层级**|`MarketDataHandler`|行情数据的解码与格式转换|该类同时负责行情存储、策略推送|仅保留解码逻辑；存储交给`MarketDataStorage`，推送交给`MarketDataPusher`|行情格式变更（如从JSON改Protobuf）时，无需修改存储和推送逻辑|
||`StrategyExecutor`|策略逻辑的执行与信号生成|该类同时负责订单提交、仓位计算|仅生成交易信号；订单提交交给`OrderSubmitter`，仓位计算交给`PositionCalculator`|策略逻辑修改时，不会影响订单提交和仓位计算的稳定性|
||`OrderManager`|订单生命周期的管理|该类同时负责风控校验、日志打印|仅管理订单状态；风控交给`RiskChecker`，日志交给`TradeLogger`|订单状态机调整时，不影响风控和日志模块|
||`RiskController`|风险规则的校验与触发|该类同时负责资金查询、告警发送|仅执行风险校验；资金查询交给`CapitalManager`，告警交给`AlertSender`|风控规则更新时，无需改动资金查询和告警逻辑|
|**方法层级**|`processTradeSignal()`|转换策略信号为标准订单参数|该方法同时校验风控、提交订单|仅做信号参数转换；风控校验调用`checkRisk()`，提交订单调用`submitOrder()`|信号格式调整时，不影响风控和订单提交的逻辑|
||`saveMarketData()`|存储行情数据到数据库|该方法同时解析行情、格式化数据|仅执行数据库存储；解析交给`parseMarketData()`，格式化交给`formatData()`|存储介质变更（如从MySQL改Kafka）时，无需修改解析和格式化逻辑|
### 对照表核心说明

1. 量化交易系统对**低延迟、高稳定性**要求极高，通过SRP拆分模块/类/方法后，单个模块的变更不会扩散到其他核心链路，降低故障风险。

2. “变化原因独立”是设计的核心——比如行情模块的变化原因是**行情源/格式变更**，策略模块的变化原因是**策略算法迭代**，二者完全独立，必须拆分。

我可以帮你基于这个对照表，生成**量化交易系统遵循SRP的架构图**，需要吗？
> （注：文档部分内容可能由 AI 生成）